name: Spring boot build test

on:
  pull_request:
    branches:
      - Develop

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      AWS_ACCESS_KEY_ID: "mock-aws-access-key-id"
      AWS_SECRET_ACCESS_KEY: "mock-aws-secret-access-key"
      AWS_DEFAULT_REGION: "mock-aws-region"
      S3_BUCKET: "mock-s3-bucket-name"
      JWT_SECRET: "mock-jwt-secret"
      MYSQL_USERNAME: "mock-mysql-username"
      MYSQL_PASSWORD: "mock-mysql-password"
      DB_URL: "mock-db-url"
      GOOGLE_CLIENT_ID: "mock-google-client-id"
      GOOGLE_CLIENT_SECRET: "mock-google-client-secret"
      GOOGLE_REDIRECT_URI: "mock-google-redirect-uri"
      KAKAO_CLIENT_ID: "mock-kakao-client-id"
      KAKAO_CLIENT_SECRET: "mock-kakao-client-secret"
      KAKAO_REDIRECT_URI: "mock-kakao-redirect-uri"

    steps:
      - name: âœ”ï¸ ë¦¬í¬ì§€í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
        uses: actions/checkout@v4

      - name: âœ”ï¸ JDK 17 ì„¤ì¹˜
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: âœ”ï¸ Gradle ëª…ë ¹ ì‹¤í–‰ ê¶Œí•œ ì„¤ì •
        run: chmod +x gradlew

      - name: âœ”ï¸ Debugging Environment Variables
        run: |
          echo "ğŸ” AWS_ACCESS_KEY_ID: $AWS_ACCESS_KEY_ID"
          echo "ğŸ” AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY"
          echo "ğŸ” AWS_DEFAULT_REGION: $AWS_DEFAULT_REGION"
          echo "ğŸ” S3_BUCKET: $S3_BUCKET"
          echo "ğŸ” JWT_SECRET: $JWT_SECRET"
          echo "ğŸ” MYSQL_USERNAME: $MYSQL_USERNAME"
          echo "ğŸ” MYSQL_PASSWORD: $MYSQL_PASSWORD"
          echo "ğŸ” DB_URL: $DB_URL"
          echo "ğŸ” GOOGLE_CLIENT_ID: $GOOGLE_CLIENT_ID"
          echo "ğŸ” GOOGLE_CLIENT_SECRET: $GOOGLE_CLIENT_SECRET"
          echo "ğŸ” GOOGLE_REDIRECT_URI: $GOOGLE_REDIRECT_URI"
          echo "ğŸ” KAKAO_CLIENT_ID: $KAKAO_CLIENT_ID"
          echo "ğŸ” KAKAO_CLIENT_SECRET: $KAKAO_CLIENT_SECRET"
          echo "ğŸ” KAKAO_REDIRECT_URI: $KAKAO_REDIRECT_URI"

      - name: âœ”ï¸ Gradle build
        run: ./gradlew build -x installLocalGitHook -x spotlessInternalRegisterDependencies -x spotlessJava -x spotlessJavaApply -x spotlessApply -x spotlessJavaCheck -x spotlessCheck -x test

      - name: âœ”ï¸ Gradle test
        run: ./gradlew --info test -Dspring.profiles.active=test
